import java.math.BigInteger
import java.math.MathContext
 
object ponder {
def primeFactorsContainOnlyTwoAndFive(x: Int): Boolean = {
// divide it by 2 until you can't, then divide it by 5 until you can't. Is the result 1?
var xv = x
  while(xv % 2 == 0){
   xv=xv/2
  }
  while(xv % 5 == 0){
   xv=xv/5
  }
xv == 1
}                                                 //> primeFactorsContainOnlyTwoAndFive: (x: Int)Boolean
def factorsOtherThanTwoAndFive(x: Int): Int = {
// divide it by 2 until you can't, then divide it by 5 until you can't. Is the result 1?
var xv = x
var b2=0
var b5=0
  while(xv % 2 == 0){
   xv=xv/2
   b2=b2+1
  }
  while(xv % 5 == 0){
   xv=xv/5
   b5=b5+1
  }
xv
}                                                 //> factorsOtherThanTwoAndFive: (x: Int)Int
def isPrime(x:Int): Boolean = x match {
case 1 => true
case _ => (2 to math.sqrt(x.toDouble).toInt).forall(y=> x%y != 0)

}                                                 //> isPrime: (x: Int)Boolean
isPrime(7)                                        //> res0: Boolean = true
isPrime(51)                                       //> res1: Boolean = false
isPrime(53)                                       //> res2: Boolean = true
factorsOtherThanTwoAndFive(320)                   //> res3: Int = 1

primeFactorsContainOnlyTwoAndFive(9)              //> res4: Boolean = false
primeFactorsContainOnlyTwoAndFive(15)             //> res5: Boolean = false
primeFactorsContainOnlyTwoAndFive(30)             //> res6: Boolean = false
primeFactorsContainOnlyTwoAndFive(31)             //> res7: Boolean = false
primeFactorsContainOnlyTwoAndFive(16)             //> res8: Boolean = true
primeFactorsContainOnlyTwoAndFive(80)             //> res9: Boolean = true
 
 val nbonus5 = (for {
  b5 <- 0 to scala.math.pow(2,6).toInt
  }
 yield{
  (BigInt(5).modPow(b5, BigInt(10).pow(8)),b5)
  }).filter {x=>x._1.toString().reverse.dropWhile(_ == '0').reverse.takeRight(8)/*.filter { x => x != '9' && x != '0'}*/.distinct.length() == 8 }
                                                  //> nbonus5  : scala.collection.immutable.IndexedSeq[(scala.math.BigInt, Int)] 
                                                  //| = Vector((37890625,48))
  
  
 val nbonus2 = (for {
  b <- 0 to 4*scala.math.pow(5,7).toInt
  }
 yield{
  (BigInt(2).modPow(b, BigInt(10).pow(8)),b)
  }).filter {x=>x._1.toString().reverse.dropWhile(_ == '0').reverse.takeRight(8).filter { x => x != '9' && x != '0'}.distinct.length() == 8 }
                                                  //> nbonus2  : scala.collection.immutable.IndexedSeq[(scala.math.BigInt, Int)] 
                                                  //| = Vector((78345216,1324), (15284736,1836), (75186432,3125), (28417536,11716
                                                  //| ), (76451328,11747), (32765184,16434), (42317568,23675), (38571264,25486), 
                                                  //| (45812736,28136), (72481536,28616), (72154368,29735), (37421568,32975), (37
                                                  //| 165824,33130), (52637184,33734), (83146752,35901), (21754368,37235), (45312
                                                  //| 768,38515), (48736512,39309), (58643712,44669), (85372416,44844), (56431872
                                                  //| ,49857), (72163584,53494), (28371456,53628), (75216384,55014), (42375168,55
                                                  //| 095), (15637248,59451), (67152384,62414), (73852416,62844), (42817536,64216
                                                  //| ), (32184576,66620), (81524736,68336), (34186752,72901), (71845632,73485), 
                                                  //| (28475136,75176), (34576128,75207), (73184256,75908), (53842176,81680), (65
                                                  //| 173248,83651), (27841536,84616), (16547328,85947), (48517632,86085), (73241
                                                  //| 856,86668), (12485376,93100), (24581376,93200), (67325184,95434), (78315264
                                                  //| ,98086), (76253184,98134), (84563712,103169), (23187456,107728), (57618432,
                                                  //| 108725), (78241536,112116), (76845312,113749), (72354816,114684), (41273856
                                                  //| ,117368), (41285376,123100), (54821376,124700), (71283456,127328), (3154867
                                                  //| 2,130497), (21763584,130994), (43527168,130995), (81432576,132920), (845176
                                                  //| 32,136085), (42587136,137876), (37456128,138707), (17653248,139651), (68435
                                                  //| 712,141769), (73456128,151207), (82354176,151380), (86314752,156301), (8147
                                                  //| 6352,156781), (46153728,157227), (13572864,158126), (18346752,158401), (752
                                                  //| 34816,160184), (18245376,161600), (62371584,163194), (34857216,165524), (65
                                                  //| 712384,166414), (53178624,168450), (51738624,169950), (63145728,170627), (4
                                                  //| 5683712,171669), (87531264,171986), (43128576,173020), (48563712,178169), (
                                                  //| 46351872,178357), (61357824,180430), (24173568,183875), (31765248,188551), 
                                                  //| (42875136,190176), (31578624,190950), (63157248,190951), (85234176,191880),
                                                  //|  (17365248,196051), (51637248,196951), (61385472,201137), (47536128,204707)
                                                  //| , (13865472,205137), (14328576,205520), (54736128,207207), (15738624,207450
                                                  //| ), (42137856,208768), (75416832,209945), (58731264,214486), (18634752,21480
                                                  //| 1), (65843712,217169), (52176384,219014), (71684352,219181), (25371648,2211
                                                  //| 31), (16374528,221887), (18452736,222136), (37184256,225908), (74368512,225
                                                  //| 909), (31267584,227094), (13526784,229874), (41386752,232901), (37241856,23
                                                  //| 6668), (61834752,237301), (47213568,239375), (76384512,241709), (27514368,2
                                                  //| 41735), (81764352,243181), (27341568,246975), (86153472,247537), (48312576,
                                                  //| 248420), (32571648,248631), (42713856,248868), (23417856,249268), (46835712
                                                  //| ,249269), (47651328,251747), (56173824,253330), (56178432,256725), (1327564
                                                  //| 8,262431), (56143872,262457), (52731648,263131), (26371584,263194), (527431
                                                  //| 68,263195), (57613824,264330), (58427136,264376), (16752384,264914), (52148
                                                  //| 736,268736), (34258176,268780), (58473216,273624), (37852416,275344), (6413
                                                  //| 8752,276001), (84736512,276809), (45176832,280445), (17835264,281086), (473
                                                  //| 21856,282168), (84312576,285920), (61475328,286547), (51284736,289336), (53
                                                  //| 641728,289827), (83561472,290937), (43785216,292824), (35126784,294874), (7
                                                  //| 3421568,295475), (31465728,297127), (17586432,298125), (35172864,298126), (
                                                  //| 43561728,298827), (87123456,298828), (12473856,299868), (72315648,300431), 
                                                  //| (73165824,308130), (31827456,309228), (53148672,310497))
  //.filter(x=> primeFactorsContainOnlyTwoAndFive(x._2))
 //.filter(x=> isPrime(factorsOtherThanTwoAndFive(x._2))) map (x=> (x._1, x._2, factorsOtherThanTwoAndFive(x._2)))
 
 //nbonus2.sortBy(x=>x._3)
 
 nbonus2.size                                     //> res10: Int = 167
 val vb2hash = (nbonus2 map (_._2)).toSet         //> vb2hash  : scala.collection.immutable.Set[Int] = Set(309228, 246975, 205520
                                                  //| , 268736, 275344, 95434, 16434, 157227, 295475, 298828, 151207, 130994, 247
                                                  //| 537, 264376, 64216, 62414, 44844, 219181, 249268, 23675, 38515, 183875, 536
                                                  //| 28, 165524, 168450, 161600, 73485, 3125, 59451, 208768, 225909, 300431, 117
                                                  //| 16, 75176, 93100, 262457, 205137, 127328, 66620, 248420, 282168, 207450, 26
                                                  //| 8780, 227094, 229874, 160184, 113749, 55095, 263195, 107728, 178169, 72901,
                                                  //|  1836, 251747, 170627, 112116, 225908, 289336, 86085, 221131, 132920, 75207
                                                  //| , 299868, 166414, 273624, 103169, 276809, 1324, 139651, 81680, 188551, 2492
                                                  //| 69, 241709, 236668, 32975, 286547, 11747, 294874, 49857, 196051, 37235, 308
                                                  //| 130, 292824, 190176, 108725, 310497, 190951, 158401, 290937, 85947, 28616, 
                                                  //| 207207, 124700, 136085, 248868, 239375, 248631, 156301, 55014, 138707, 2190
                                                  //| 14, 151380, 53494, 25486, 256725, 297127, 214486, 171669, 33734, 263194, 17
                                                  //| 3020, 264330, 243181, 141769, 263131, 123100, 204707, 180430, 237301, 84616
                                                  //| , 214801, 298126, 98086, 86668, 281086, 169950, 217169, 221887, 114684, 297
                                                  //| 35, 163194, 98134, 241735, 62844, 298827, 156781, 130995, 191880, 289827, 9
                                                  //| 3200, 201137, 264914, 190950, 222136, 130497, 196951, 28136, 253330, 276001
                                                  //| , 83651, 262431, 35901, 178357, 158126, 232901, 39309, 285920, 75908, 17198
                                                  //| 6, 44669, 137876, 117368, 209945, 33130, 68336, 280445, 298125)
 
 val b2 =2                                        //> b2  : Int = 2
 val b5 = 6                                       //> b5  : Int = 6
   val pBig = BigInt(2).modPow(b2, BigInt(5).pow(7)*4) * BigInt(5).modPow(b5, BigInt(5).pow(7) *4)
                                                  //> pBig  : scala.math.BigInt = 62500
  ( pBig * (b5-b2) % (BigInt(5).pow(7) *4 )).toInt//> res11: Int = 250000
  ( pBig  % (BigInt(5).pow(7) *4 )).toInt         //> res12: Int = 62500
  
 
 (Stream.from(0) map (b5 =>
  for
  {
   b2 <- (0 to 10)
 //  b5 <- (b2+1 to b2+4)
  }
  yield
  {
//  (10^{b_{5}}+2^{b_{5}-b_{2}})^{p}
  val pBig = BigInt(2).pow(b2) * BigInt(5).pow(b5)
  if (b5>b2)
  (b2,b5, (BigInt(10).pow(b5) + BigInt(2).pow(b5-b2)).modPow(pBig,BigInt(10).pow(8)))
  else
  (b2,b5, (BigInt(10).pow(b2) + BigInt(5).pow(b2-b5)).modPow(pBig,BigInt(10).pow(8)))
  }
  )).take(100).toList.flatten
  //.filter {x=>x._3 != BigInt(87109376) }
  //.filter {x=>x._3.toString().reverse.dropWhile(_ == '0').reverse.takeRight(8).filter { x => x != '9' && x != '0'}.distinct.length() == 8 }
 .filter {x=>x._3.toString().reverse.dropWhile(_ == '0').reverse.takeRight(8).distinct.length() == 8 }
                                                  //> res13: List[(Int, Int, scala.math.BigInt)] = List((4,1,37890625), (0,5,5918
                                                  //| 6432), (0,9,79186432), (0,13,79186432), (0,17,79186432), (0,21,79186432), (
                                                  //| 0,25,79186432), (0,29,79186432), (0,33,79186432), (0,37,79186432), (0,41,79
                                                  //| 186432), (0,45,79186432), (0,49,79186432), (0,53,79186432), (0,57,79186432)
                                                  //| , (0,61,79186432), (0,65,79186432), (0,69,79186432), (0,73,79186432), (0,77
                                                  //| ,79186432), (0,81,79186432), (0,85,79186432), (0,89,79186432), (0,93,791864
                                                  //| 32), (0,97,79186432))
 
  val pBig2 = BigInt(2).pow(0) * BigInt(5).pow(5) //> pBig2  : scala.math.BigInt = 3125
 (BigInt(10).pow(5) + BigInt(2).pow(5)).modPow(pBig2+1,BigInt(10).pow(8))
                                                  //> res14: scala.math.BigInt = 37165824
 (BigInt(100032)).modPow(3126,BigInt(10).pow(8))  //> res15: scala.math.BigInt = 37165824
// Checks out in WA
// For y
/*
 (Stream.from(0) map (b5 =>
  for
  {
   b2 <- (0 to 10)
 //  b5 <- (b2+1 to b2+4)
  }
  yield
  {
//  (10^{b_{5}}+2^{b_{5}-b_{2}})^{p}
  val pBig = BigInt(2).pow(b2) * BigInt(5).pow(b5)
  if (b5>b2)
  (b2,b5, (BigInt(10).pow(b5) + BigInt(2).pow(b5-b2)).modPow(pBig+1,BigInt(10).pow(8)), (BigInt(10).pow(b5) + BigInt(2).pow(b5-b2)).modPow(pBig+1,BigInt(10).pow(10)))
  else
  (b2,b5, (BigInt(10).pow(b2) + BigInt(5).pow(b2-b5)).modPow(pBig+1,BigInt(10).pow(8)), (BigInt(10).pow(b2) + BigInt(5).pow(b2-b5)).modPow(pBig+1,BigInt(10).pow(10)))
  }
  ))/*.take(1000).toList*/.flatten
  //.filter {x=>x._3 != BigInt(87109376) }
  .filter {x=>x._3.toString().reverse.dropWhile(_ == '0').reverse.takeRight(8).filter { x => x != '9' && x != '0'}.distinct.length() == 8 }
  .foreach(println)                          */
         
 //.filter {x=>x._3.toString().reverse.dropWhile(_ == '0').reverse.takeRight(8).distinct.length() == 8 }
 
/*
 (Stream.from(1) map (b5 =>
 for
 {
  b2 <- (0 until b5)
  if (vb2hash contains(
  {
  ( (b5-b2) % (BigInt(5).pow(7) *4 )).toInt
  }
  ))
  }
  yield
  {
  (b2,b5)
  }
 )).filter(x=>x != Vector()).foreach(println)*/

 /*
 val sbonus2 = for
 {
  b5 <- (20000 to 2000000)
  b2 <- (0 until b5)
  if (vb2hash contains(
  {
  val pBig = BigInt(2).modPow(b2, BigInt(5).pow(7)*4) * BigInt(5).modPow(b5, BigInt(5).pow(7) *4)
  ( pBig * (b5-b2) % (BigInt(5).pow(7) *4 )).toInt
  }
  ))
  }
  yield
  {
  (b2,b5)
  }
 



   val sbonus = (for
{
  b2 <- (0 to 20)
  b5 <- (0 to 20)
  }
yield
{
 val pInt = (scala.math.pow(2,b2) * scala.math.pow(5,b5)).toInt
 val pBig = BigInt(2).pow(b2) * BigInt(5).pow(b5)  //BigDecimal(pInt,new java.math.MathContext(1000))
 
 val k0 =
 if ( b2 > b5)
  BigInt(2).modPow(pBig*(b2-b5),BigInt(10).pow(8))
  else
  BigInt(5).modPow(pBig*(b5-b2),BigInt(10).pow(8))
 val k1 = (k0*pBig.modPow(2, BigInt(10).pow(8))).mod(BigInt(10).pow(8))
 val k2 = (k0*(pBig.modPow(4, BigInt(10).pow(8))- pBig.modPow(3, BigInt(10).pow(8)))/2 ).mod(BigInt(10).pow(8))//(p^4-p^3)/2 * k0
 val k = k0+k1+k2
 val xstring = k.toString()
 val lastchars = xstring takeRight(8) filter { x => x != '9' && x != '0'}
 (b2,b5,lastchars.distinct.length(),pBig,k0,k1,k2,k,xstring)}
 ).filter(_._3==8)
   */
// verified with wolfram alpha 2^(5*3125) mod (10^8) = 59186432 and the k1 term =0.
// But weirdly that p=3125 doesn't verify in wolfram alpha., last digits are 7291026659218
// Aahhh, even weirder, wolfram does work when you do (1+1/3125)^3125 * 10^15625, but doesn't work when you do p=3125, (1+1/p)^p then ask for more digits.
// 271784703090556175397888909202415555558659069331031018789253795016530459844583786713722194577252083782048896082110740347969868121777893165228764941907955886703602206027010963804429321649485328199599575817165959765323633560263184653981432793939586127873533164835686343524896431765422010275343497392037126346397640668743017946200875767260590473820002109475019570824715522763587794367865570279914441723068147875255360717033670305547065726376354513628319069282000812878015749612472324342193954497568068059814901833181428570226758403117797362059568808848274293748138947493886826722329272908498135298876915416993719535029389654086526251711626220686936071970333380080146134221121901052202106024513237146263471221628432586097981094984229323406438494192524487928948709969407122340477062017697829470771071161863638694244929157731417922726266523878007486906308685683361698414637431805410057267115592585556811713920566020877809729144356507691177684524265467215562169732996526722093589381088929016998910081353439573732855582486039114765247619481089861827732876788430588505686008066539004754249842976607298286682647242216440042232895172575938422770940843250792521212820152594447229177042284317343739251813096381749344246119635074173579745965592236421963002788645519999213166414073062453059937468885838113517127348308600813684692351653109286458638903993517622889007763854159267343712400217170807138858054620656251431855170809919111680957052159277078080767790398461394281816165373217402821842650711660345537998173559123060429892652369200609848484783005113883499579989491238318243147446426540970425646341798197515482374662403450475664893026483586206273364710155112405128953619202685953412078550164755735349542664898648629384119656856282613796356091894287494336406245021887899005837295645959815376643684364540169576288346780501732919158424762383008175419236371324707675830739101273792173105449377798310759087826888958626590799370415575300076415954341175717526854963575028938859735191014139519870673706245077040555543045780545593530248723722295144509259437867991464236944987461721666427404137012720253273780806212450691624019825708839531128463277371463352357191805119484394356387707618280772202757755931467310410228538894061964919731085622110817255268671564350804523563490759136077213638176202959551617479713948243818491191634255843819456904409424776855054901118825826799048889184919431494000719045256283466732772847757908139008166539227895066254119965703703410223784841352704616627450842908889493434557499809396298937500895879545596126032447202243119850721569936239359396663776918966498898169178666073244485605140302593293396417307601669486599380175723652954678450840081409347424633959265868795950690731901296034491619430670535801935044912912989229389060412177576084676026795091398507736108307748094000573804494792384484271844424686998942226438295647984635792329942810014980438876972214968106018531260554771912500268838729794451466642501444831763430570814631715043851661912784929206057082131529344314974303898512998221057140979980304928320667115151577153079125375517827356900217574076688611034679642100544034756884448559977266278655955732608423421569474014377562063937106821613012202061255847725064401860072910266592179453729234380996765298216481896523332609050853901522494157981757835101856765241687094447498517012761996555490264585487406185847866529111593362196744463876709136400497993949967535750074913907881243760546704183943038067816711901298840042556549825457086875507054448378674512561973893419602644454418078680594472979778841565868753069832566782948340095012131823093335040383553821059356150090915937558572832159042934771652075351488176178162984122569103722052490055893533191908833938447392048974267268177233567021936084788512057358700621761655738287211763744031772961372537084711123514714473956224994786167957520710277404983694579868263343505960817120233335270986800823087689695135989864338350867521966995732079576494532204187092026514992373191653722368398657144827001016891760814088125262974083553005652391916917485287658877276071028628135756513794931871458815462235373288088931257548567312835064800232258969649026549168226783457140403486812298307424030719291644269753825417246751046670723430564511160227985261340177086285815197020171543524389530960125532741424947492041965906147494599063710049558980212904830157962324554249147975041565314029211063443730363974926639788310832325870824084863257309188654180467754464498314449358504587599818543650789953451643011294562643022435304476541860419825177579818532202348464637366799088041165058578354751310431607546522315016510000921516357191841038734806654396166370853881779066212734761033126297373823748959928579560910080847992674567823703783250062283307054695658815732282740961263909191351024317554461326714205889235583641907738304700717434980018317291429073787331717428221203088336446040811911459857756716555272345772665404173176048144779713402334192058739563855633987960731819926562262827659180681303884073631632504805490371488915136413542723103717204679557266370494504222104237122153925894448269010222766262650554830941926494328227555946449878149696086344349782973106510274061691941648764282628626318984308918241829902693659991443020701012036699164532847906262273758665243913054518329237067019662291884206935643457945807175527894889336184772908693358893632852935649488574780866963541398740898732765925803576235075794540967523255256014057700169775191358069757282326852227297225227364050672145701650156557548964840123834779538985069940935531277537498479650522336930425712344005575731561213902219345501217692747587611004239653920943125495414311190718391361107759934462302986983794823050963711724443073835530955932681206332027044654764221650664218538701681127989583450587793154005203453259532532678052243111489395041470046295530510689441542800339824715925723785119692249821683776193508765631806032311917109423103064184642960270299034299177079742614365622421504591024060732131803037616741375314532306296231943482544541622863510588070988123731318548577237442140182415026360489852781396277159136600720870558183852016011157974618276974050388497836470594022619279755838819478328537669387524531493125531821985929940845635269406377879952250293613947587141501811461845842790721653982906120210662189192112985703698037463472969548787877206907876835325611592293606581354673379811476592209308295811153584381508726074439984873474544673018531660517429647898551293896018188798774587662177019821592119419074876843632738466954794260230578199999040572408019127085726326426167428393798800299487442214776119207900055100334321785270117978743120823432505606560975294012737256172493695982926043646449768531132956001290314443451463413371599714241144745433268128060113245658142022283543313891850462884622890485902039661373962923170410379819634775559011720881932853242159886037296872555605650156912548421170366099174296693509154298162022072407401779208737697030780542071483358135520541526701470349822047368090412544016805186549886002725107041502166865039788706722609704488111097942978686366384006396070527934792622777567914587171620042687672436393443126571019648959172949551389252251844357591468657366361280623300172327506630498673691853556031274602398303942404895684892803559561616317537155286063657376610952137487410072937166872400468310869228142100212177535369693685960142463111606860852523627262203802659682410693901358003315140987467564504907257195813402930186231352697562043765357179506139773276297415480855132667718856491446831286219100350610159088974661588546012840204844533628074985047610138009280908512958248233025375855850765555344997243349908313952948119177756580833756969187729730445816654975639920595672901446444470154423502543529591600323291288329913992154693515788175508324437875326141746008702363003360047900862230656650727382539166866632668356805173422484190556105170864279737944850761673663317961974162749449405716933711423927349272978119574015159591846808433078556704808766700608486847502095135317165096752342356532622556576319762570536559842979956277349834049383952425887108563401723415332502030058111128253091133834686394046629067887867317436437338635351686476929295973498378812050320983404057694620182501069982651461478442489450624117867281709685205512465613818205985676849837172593059821388661020769015818285204335235332702269124122229896620721931009945346543598042058028731552814997706452664278174746482825083867829308084315754952812059929617532243620609512931880627560147021819850039343524411050316855958970169808589483270761966156860204127317187983357642208891624289262127312991950764751957843180214227501991501027991849755414767856061875423215155144088375316845710685485654052170049734732633222983100502467475906359803591765004452821875553256791046679410972617928628737724388700241944887393090533861510959154643523389885737449423496853682345873477690204681444656321568696519870138034016174730365830306994073673343637103641111474063127436372309317880740896179785103663846841159198648591483761291366821962954708190174516629532630683549837122348331223848071540700135906074681679439394920527637033693854568415331471041364793420119844813084760107710184825232894266127015465940742681776052733436550114418390182660800282997993217809323423357990323659812847276377715730916127382137486375821060868922973186834590325020154331930803309649699992298110916514730150604305950744819313261055441360046700345183745290512489684820578436526715048628253988726292254672906457483530753205017062039507237148077204680937125603361566891908206888560243891651401778829487865249762806476370352496860983280343957953237405124562510741374759105818931571444684640906237032778713749454105662667122927010673460261286313368540494556500783323524846753687570379362719146483282904647242633568438757218391300309452276314332952451663818326026784588545280031232951573551598717899770315880685675851540151174884161478057921115496196080448282559341695480235036863697599853892537437218740767587859228486719652112109607516918340175331306436074514790982099791587224880736474374814544902396779591826034153598351788172541947847159052443703822766261218602905257137044465037743385860260913428317688809939250241040573918843811093740205644263939781245705596310022469515957134249601930462785105881433081217623220111001912253357143100322435236451821610874293942515723841794297565362019062325066238142621423032725379817362316738032781776490507509976858633742242407497434206944346799080540030643631554690901472305241665778753231491456150776702844741748454318485613912513566645340586070231750791169839643225265216003092167427239515622972221511380248365971649074103617559731887638401513473087405236587666161859242610082169655315751628640115145415811353233614156768902907042553906978207211220220316914246431460723618764694175756691957553211332502143633816026152137815671925792240022193376738443783481234041917786225245033606921360536501874795577239548890315582480698627505034016387074383152776281638824560994708380369558997156834014500649458938455650773649181605894455006077261465581593644712557873663091094349923315077348537076574496870634355159019045580937071017201617589109933704264504004128220716619301274958438276305526855931951764732292110631105140291063535537265789844605961117587271554070923133945109443257162330858275820151181041975029374840121483143543097667599920404824609276750351101480774842788961688726268317690636128328795366628153399158740071751749799209404585431736396054715694499361786323315973969062341057403323315111620427209533798792556329955055382196217415461991406376627993895165186098198433372298789847758623201682690231790206252294132684727026113954822430688960756696449934334447199595775957616414427837403836421591058816727798257031105064234105315628554789225959230745057018352037311708318501775891359551464362381186181139187671931165046820888129406310331970345656485924695255817795566625264792809520704765139071746580716872212939634504029256788597088587911564414318559094933805314270831428912323704607891385537849859222116757431197806722469807282795407216784821600110952867147222860693015096349024594338410458039514775244485219947356277817339179147935251985602623823532934903031810153460290560687681253474452956462198811139852039209495175460330396201923495957327010769489852711616908790662406064105004604414004367824688447910913909035637223157672418989843562867067497989260592024740495940289744041021929025866621202717211759251483307364885250354433738724141266480422411800366481520969863522004821882928135829252734714939082545814841123035714329241750120223870420745938093397703226316640271876816227557811408906020553322049425553127984660540138123959703348642725855012425811859070109998840244893883486226306973412409857422792112965410843368786453620144158078307565563113906364292853601566509324396056432123451818396876311408472739100882498065911783354242714128766902519001328318942334475115022312496743059886062687860994275510684729327006782416802179118631702601061396165765294363213358353198694394726309526233381379726375696924792141782214781163969890726236404414363161868616132515727025549081288276670640619558666011933931207436765230050552814680734618111493042849574881324469300517748677663977550059980330896286015323651075738431445491329965205972603829249959402885621955533413151546145906128201960657563803455276398032935500294594578350673873952407353525349847813350267983363148427382385511898811244381919188817569680640889888417574350553173032180073991303070149151587829194761872371255542365181940127170781421406039586145325019090290445601072129146588384808052444916829889391600180283651061012014874950523413315431548311141984076277528799626844335195691648693115449501960778331074053534814160033961140203801571017192083777285400535326998016918347270027062390793451800394229154240776751566790981150234918065129514569944712335114386079783063263351200634146377517250405044492878333880482591750563876273957707078888270258386683094961850408635519847150002392256941398638441164146572509562079471094840244516114041425199226797552578150147450517721565840115509415003674015850824071603669516671068397192108861917983544843919880783296300213142381580156888980688807385400198830554871553355684597520935658300700385637921341311085389423532469075137245426007339003653733685929420075942802469828461483167892312124259529694048464010881446717180134867861300241127848455329256176987159261672236953710686179176169500736016723679874084257458706498124511644277227002855752004853051780110244873219605697632342610017170617103480909284478118469876693067175782977718376779647284498457591066438026453774919350888942176919359039320764984729339654782839605218251329295040253180025458422108900489740940031153811238257640885440760870410755927918464601590275049791130672272148284463203644355563154866753158582334546197883396707951426151909839875488373787037143353677618350221224455027084652705959792820541507877756702874106388005731356759255165585641099102420412668345954332785789688850668020578606374446026135480106508092429541004273999464458474936624216745106799827950655976092404303917927583294841067519625570354487112735028284367680066180778023371081453925451033516897623898639068616438094095894938109954147340069043042953715561257634309915087223597492314893418278943154876187669344246305017687528516976892125325780734830867026766056057793893762806941073182230901406201226396075479458867452526169606614084563596488970185832567586421971837036519719694125639003079832586497254480066091518903086751670052740455607614515718795687629429355618672906676015396896971072531303723995079891112574455176385916428615869556693251251283367964480350340358083661934559308691358899064597032554133125629730743505193824735267564219978513478277944465365860163 59186432

/*  println("Welcome to the Scala worksheet")
  val pInt = 9
  val pBig = BigDecimal(9)
  pBig.toInt
//  val x=(p.add(BigInteger.valueOf(1))).divide(p).pow(p.toInt)
  val x = ((pBig+1) / pBig)
  val x2 = x.pow(pInt)
  
  BigDecimal(3)/ BigDecimal(7)
  */
  //val string = "hello"
//string.distinct.length()
 
  // p needs to be of the form 2^pi * 5^pj
  
  val s = (for
{
pi <- (0 to 8)
  pj <- (0 to pi)
  }
yield
{
val pInt = (scala.math.pow(2,pi) * scala.math.pow(5,pj)).toInt
// val pBig = BigDecimal(pInt,new java.math.MathContext(5000))
 val pBig = BigDecimal(pInt,new java.math.MathContext(1000))
 val  x = ((pBig+1) / pBig)
 val  x2 = x.pow(pInt)
  val xstring = x2.toString()
 val lastchars = xstring takeRight(8)
 (pi,pj,lastchars.distinct.length())}
 ).filter(_._3==8)                                //> s  : scala.collection.immutable.IndexedSeq[(Int, Int, Int)] = Vector((4,1,
                                                  //| 8))
 
/*
 s  : scala.collection.immutable.IndexedSeq[(Int, Int, Int)] = Vector((4,1,8)
                                                  /
477311073811304114486478503581164406916224853039238513850085608145771986880516808459166772134240378240755073828170296740373082348622309614668344831750401/
176684706477838432958329750074291851582748389687561895812160620129261977600000000000000000000000000000000000000000000000000000000000000000000000000000000

n=2^4*5^1, (1+1/n)^(n)
(1/n + 1)^n≈2.70148494075333709832461456878272238792475107326700486288341959037974809305412210036181253333608719811463892995757
2246876808976510732963225237254414392957161412764897620468903044744861276984746297374070128239740546388495676421384908756690186
877374425850370336770159484671858038254757539142758560046786442399024963  37890625
*/

/*
val sbonus = (for
{
pi <- (0 to 11)
  pj <- (0 to 8)
  }
yield
{
val pInt = (scala.math.pow(2,pi) * scala.math.pow(5,pj)).toInt
 val pBig = BigDecimal(pInt,new java.math.MathContext(0))
 val  x = ((pBig+1) / pBig)
 val  x2 = x.pow(pInt)
  val xstring = x2.toString()
 val lastchars = xstring takeRight(8)
 (pi,pj,lastchars.filter(x => x != '9' && x != '0').distinct.length())}
 ).filter(_._3==8)
*/
  def binomialCoefficient(n: Int, k: Int) ={
    if (k > n/2.0)
    {
    val k2=n-k
    (BigInt(n - k2 + 1) to n).product /
    (BigInt(1) to k2).product
    }
    else
    {
    (BigInt(n - k + 1) to n).product /
    (BigInt(1) to k).product
    }
    }                                             //> binomialCoefficient: (n: Int, k: Int)scala.math.BigInt
    
/*val testBinom =  binomialCoefficient(3126, 11)
val testBinom2 = scala.BigDecimal(10).pow(-11*5) * scala.BigDecimal(2).pow(5*11)
val testBinom3 = BigDecimal(testBinom) * testBinom2
  */
val nbonus = for
{
b2 <- 0 to 0
b5 <- 5 to 5
}
yield{
 	(for
	{
   k <- 0 to 14
  }
  yield
  {
 // (p+1 choose k) * 10^-kb5 * 2^kb5
 val p = (scala.math.pow(2,b2) * scala.math.pow(5,b5)).toInt
 val a = binomialCoefficient(p+1, k)
 val b = scala.BigDecimal(10).pow(-k*b5) * scala.BigDecimal(2).pow(b5*k)
   BigDecimal(a) * b
 })}                                              //> nbonus  : scala.collection.immutable.IndexedSeq[scala.collection.immutable
                                                  //| .IndexedSeq[scala.math.BigDecimal]] = Vector(Vector(1, 1.00032, 0.50016000
                                                  //| 00, 0.166666649600000, 0.04163999573606400000, 0.0083200042680314757120000
                                                  //| , 0.001384892443761399237181440000, 0.00019752523083591157120027852800000,
                                                  //|  0.00002464324779908832762294674915328000, 0.00000273200521377981886323014
                                                  //| 9826130739, 2.725011280432542526940280642575845E-7, 2.47014840722263345860
                                                  //| 2447849386569E-8, 2.051869943599600859612433346890443E-9, 1.57280566261394
                                                  //| 635737430583193029930E-10, 1.1191186349067920024014203553826335349E-11))
 
 nbonus.flatten.sum                               //> res16: scala.math.BigDecimal = 2.71871674195465946635751859085340029582648
                                                  //| 9265349
 
  
//nbonus filter (

  val psol = 4000000                              //> psol  : Int = 4000000
  
  val psol1 = BigDecimal(psol+1)/psol             //> psol1  : scala.math.BigDecimal = 1.00000025
  val psol2top = BigDecimal(psol+1).pow(psol)     //> psol2top  : scala.math.BigDecimal = 2.509610236686675676585177835951449E+2
                                                  //| 6408240
  val psol2bot = BigDecimal(psol).pow(psol)       //> psol2bot  : scala.math.BigDecimal = 9.232341268346647528563879137021077E+2
                                                  //| 6408239
  val psol3 = psol2top / psol2bot                 //> psol3  : scala.math.BigDecimal = 2.718281488673894545409262117540896
  val psol3s = psol3.toString()                   //> psol3s  : String = 2.718281488673894545409262117540896
  val psol4 = psol3s.takeRight(8)                 //> psol4  : String = 17540896
  
  
   
  ///p).pow(p)
  }
  
  